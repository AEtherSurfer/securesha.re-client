<!--
  Given a blob object, file-slicer chops it up into chunks of chunkSize bytes.
-->
<polymer-element name="file-slicer" attributes="input output chunkSize">
  <template>
    <style>
      @host { :scope {display: none;} }
    </style>
  </template>
  <script>
    Polymer('file-slicer', {
      //applyAuthorStyles: true,
      //resetStyleInheritance: true,
      inputChanged: function() {
        // slice & dice
        if (!this.input) return;
        var file = this.input;
        file.slice = file.mozSlice || file.webkitSlice || file.slice; // compatibility
        var pos = 0;
        var slices = [];
        while(pos < file.size){
          slices.push(file.slice(pos, pos += this.chunkSize));
        }
        // Set output - rather then pushing to this.output itself, this ensures
        // we only have one changed event
        this.output = slices;
      },
      created: function() { },
      enteredView: function() { },
      leftView: function() { },
      attributeChanged: function(attrName, oldVal, newVal) { }
    });
  </script>
</polymer-element>